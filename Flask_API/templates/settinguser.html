<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Setting</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
    
    <!-- Font Awesome -->
    <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
    rel="stylesheet"
    />
    <!-- Google Fonts -->
    <link
    href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
    rel="stylesheet"
    />
    <!-- MDB -->
    <link
    href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.3.0/mdb.min.css"
    rel="stylesheet"
    />
    <link
    href="https://cdn.datatables.net/1.10.24/css/dataTables.bootstrap5.min.css"
    rel="stylesheet"
    />
    <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
    rel="stylesheet"
    />
    <script
    type="text/javascript"
    src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.3.0/mdb.min.js"
    ></script>
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/dataTables.bootstrap5.min.js"></script>
</head>
    <body>
      <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
          <a class="navbar-brand" href="#"></a>
          <button
            class="navbar-toggler"
            type="button"
            data-mdb-toggle="collapse"
            data-mdb-target="#navbarNav"
            aria-controls="navbarNav"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <i class="fas fa-bars"></i>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link" href="/">Dashboard</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/prediction">Prediction</a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="/setting">Setting</a>
              </li>
              <li class="nav-item d-lg-none">
                <a class="nav-link" href="/logout">Logout</a>
              </li>
            </ul>
          </div>
        </div>
        <div class="container-fluid justify-content-end">
          <a class="btn btn-dark me-2 d-none d-lg-block" type="button" href="/logout"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </div>
      </nav>
      <br>
      <div class="container">

        <div class="align-items-start">

          <div class="row">
            <div class="col-4">
                <div class="list-group" id="list-tab" role="tablist">
                    <a
                    class="list-group-item list-group-item-action active"
                    id="list-mm-list"
                    data-mdb-toggle="list"
                    href="#list-mm"
                    role="tab"
                    aria-controls="Manage model"
                    >Manage model</a
                    >
                    <a
                    class="list-group-item list-group-item-action"
                    id="list-ma-list"
                    data-mdb-toggle="list"
                    href="#list-ma"
                    role="tab"
                    aria-controls="Manage account"
                    >Account setting</a
                    >
                </div>
            </div>
            <div class="col-8">
              <div class="tab-content" id="nav-tabContent">             
                <div
                  class="tab-pane fade show active"
                  id="list-mm"
                  role="tabpanel"
                  aria-labelledby="list-mm-list"
                >
                
                  <!-- Tabs navs -->
                  <ul class="nav nav-tabs mb-3" id="ex1" role="tablist">
                    <li class="nav-item" role="presentation">
                      <a
                        class="nav-link active"
                        id="ex1-tab-1"
                        data-mdb-toggle="tab"
                        href="#ex1-tabs-1"
                        role="tab"
                        aria-controls="ex1-tabs-1"
                        aria-selected="true"
                        >Model list</a
                      >
                    </li>
                  </ul>
                  <!-- Tabs navs -->
    
                  <!-- Tabs content -->
                  <div class="tab-content" id="ex1-content">
                    <div
                      class="tab-pane fade show active"
                      id="ex1-tabs-1"
                      role="tabpanel"
                      aria-labelledby="ex1-tab-1"
                    >
                      {% for table in model_list %}
                      {% if table[1] == 'db' %}
                        <div class="card">
                          <div class="card-header"></div>
                          <div class="card-body">
                            <h5 class="card-title">{{table[1]}}</h5>
                            <p class="card-text">
                              Model ID: {{ table[0] }}<br>
                              Data source: {{ table[2] }}<br>
                              Last update: {{ table[3] }}
                            </p>
                            
                            <!-- <button type="button" class="btn btn-primary m-1" data-bs-toggle="modal" data-bs-target="#exampleModal{{ table[1] }}">
                             <i class="fas fa-edit"></i> Rename
                            </button> -->
                            <button type="button" class="btn btn-primary m-1" data-bs-toggle="modal" data-bs-target="#exampleModal2{{ table[1] }}">
                              Update model
                            </button>    
                            
    
                            <!-- Modal -->
                            <div class="modal fade" id="exampleModal{{ table[1] }}" tabindex="-1" aria-labelledby="exampleModalLabel{{ table[1] }}" aria-hidden="true">
                              <div class="modal-dialog modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                  <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModalLabel{{ table[1] }}">Rename</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                  </div>
    
                                  <form method="POST" action = "/setting/renamemodel">
                                    <div class="modal-body">
                                      <div class="row">
                                        <label for="oldName" class="col-sm-3 col-form-label">Model ID</label>
                                        <div class="col-sm-9">
                                          <input type="text" readonly class="form-control-plaintext" id="modelid" name = "modelid" value={{ table[0] }}>
                                        </div>
                                        <label for="oldName" class="col-sm-3 col-form-label">Current name</label>
                                        <div class="col-sm-9">
                                          <input type="text" readonly class="form-control-plaintext" id="oldName" name = "oldName" value={{ table[1] }}>
                                        </div>
                                      </div>
                                      <div class="row">
                                        <label for="inputNewName" class="col-sm-3 col-form-label">New name</label>
                                        <div class="col-sm-9">
                                          <input type="text" class="form-control" id="inputNewName" name = "inputNewName">
                                        </div>
                                      </div>
                                    </div>
                                  
                                    <div class="modal-footer">
                                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                      <button class="btn btn-primary" type="submit" id='save'>Save change</button>
                                    </div>
                                  </form>
    
                                </div>
                              </div>
                            </div>
    
                            <!-- Modal -->
                            <div class="modal fade" id="exampleModal2{{ table[1] }}" tabindex="-1" aria-labelledby="exampleModal2Label{{ table[1] }}" aria-hidden="true">
                              <div class="modal-dialog modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                  <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModal2Label{{ table[1] }}">Confirm update</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                  </div>
    
                                  <form method="POST" action = "/setting/updatemodeldb">
                                    <div class="modal-body">
                                      <div class="row">
                                        <label for="oldName" class="col-sm-3 col-form-label">Model ID</label>
                                        <div class="col-sm-9">
                                          <input type="text" readonly class="form-control-plaintext" id="modelid" name = "modelid" value={{ table[0] }}>
                                        </div>
                                        <label for="Updatemodel" class="col-sm-3 col-form-label">Model name</label>
                                        <div class="col-sm-9">
                                          <input type="text" readonly class="form-control-plaintext" id="updatemodel" name="updatemodel" value={{ table[1] }}>
                                        </div>
                                      </div>
                                    </div>
                                  
                                    <div class="modal-footer">
                                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                      <button class="btn btn-primary" type="submit" id='update' >Update model</button>
                                    </div>
                                  </form>
    
                                </div>
                              </div>
                            </div>
                            
                          </div>
                        </div>
                      
                      {% else %}
                        <div class="card">
                          <div class="card-header"></div>
                          <div class="card-body">
                            <h5 class="card-title">{{table[1]}}</h5>
                            <p class="card-text">
                              Model ID: {{ table[0] }}<br>
                              Data source: {{ table[2] }}<br>
                              Last update: {{ table[3] }}
                            </p>
                            <form method="POST">
                              <!-- <button type="button" class="btn btn-primary m-1" data-bs-toggle="modal" data-bs-target="#exampleModal1{{ table[1] }}">
                               <i class="fas fa-edit"></i> Rename
                              </button> -->
                              <button type="button" class="btn btn-primary m-1" data-bs-toggle="modal" data-bs-target="#exampleModal3{{ table[1] }}">
                                Update model
                              </button>      
                            </form>
                            <!-- Modal -->
                            <div class="modal fade" id="exampleModal1{{ table[1] }}" tabindex="-1" aria-labelledby="exampleModal1Label{{ table[1] }}" aria-hidden="true">
                              <div class="modal-dialog modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                  <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModal1Label{{ table[1] }}">Rename</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                  </div>
    
                                  <form method="POST" action = "/setting/renamemodel">
                                    <div class="modal-body">
                                      <div class="mb-3 row">
                                        <label for="oldName" class="col-sm-3 col-form-label">Current name</label>
                                        <div class="col-sm-9">
                                          <input type="text" readonly class="form-control-plaintext" id="oldName" name="oldName" value={{ table[0] }}>
                                        </div>
                                      </div>
                                      <div class="mb row">
                                        <label for="inputNewName" class="col-sm-3 col-form-label">New name</label>
                                        <div class="col-sm-9">
                                          <input type="text" class="form-control" id="inputNewName" name = "inputNewName">
                                        </div>
                                      </div>
                                    </div>
                                  
                                  
                                    <div class="modal-footer">
                                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                      <button class="btn btn-primary" type="submit" id='save1'>Save change</button>
                                    </div>
                                  </form>
    
                                </div>
                              </div>
                            </div> 
    
                            <!-- Modal -->
                            <div class="modal fade" id="exampleModal3{{ table[1] }}" tabindex="-1" aria-labelledby="exampleModal3Label{{ table[1] }}" aria-hidden="true">
                              <div class="modal-dialog modal-dialog modal-dialog-centered">
                                <div class="modal-content">
                                  <div class="modal-header">
                                    <h5 class="modal-title" id="exampleModal3Label{{ table[1] }}">Confirm update</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                  </div>
    
                                  <form method="POST" action = "/setting/updatemodeldataset">
                                    <div class="modal-body">
                                      <div class="row">
                                        <label for="oldName" class="col-sm-3 col-form-label">Model ID</label>
                                        <div class="col-sm-9">
                                          <input type="text" readonly class="form-control-plaintext" id="modelid" name = "modelid" value={{ table[0] }}>
                                        </div>
                                        <label for="Updatemodel" class="col-sm-3 col-form-label">Model name</label>
                                        <div class="col-sm-9">
                                          <input type="text" readonly class="form-control-plaintext" id="updatemodel" name="updatemodel" value={{ table[1] }}>
                                        </div>
                                      </div>
                                    </div>
                                  
                                    <div class="modal-footer">
                                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                      <button class="btn btn-primary" type="submit" id='update' >Update model</button>
                                    </div>
                                  </form>
    
                                </div>
                              </div>
                            </div>
    
                          </div>
                        </div>
                        
                      {% endif %}
                    {% endfor %}
                    </div>
                  </div>
                  <!-- Tabs content -->
                </div>

                <div
                    class="tab-pane fade"
                    id="list-ma"
                    role="tabpanel"
                    aria-labelledby="list-ma-list"
                >
                <div class="card">
                  <div class="card-body">
                    <h5 class="card-title">{{uname}}</h5>
                    <p class="card-text">
                      User ID: {{ uid }}<br>
                      Permission: {{ permission }}
                    </p>
                    <div class="row">
                      <div class="col-sm-12 col-md-9">
                        {% if uid != 0 %}
                        <button type="button" class="btn btn-primary m-1" data-bs-toggle="modal" data-bs-target="#ModalLabel3edit{{uname}}">
                          <i class="fas fa-edit"></i> Edit username
                        </button>
                        {% endif %}
                        <button type="button" class="btn btn-primary m-1" data-bs-toggle="modal" data-bs-target="#ModalLabeledit{{uname}}">
                          <i class="fas fa-edit"></i> Edit password
                        </button>
                      </div>
                      <div class="col-lg-3 d-flex justify-content-end">
                        {% if uid != 0%}                        
                        <button type="button" class="btn btn-danger fa fa-trash m-1 d-none d-lg-block" data-bs-toggle="modal" data-bs-target="#ModalLabel2edit{{uname}}">
                         
                        </button> 
                        {% endif %}  
                      </div>
                      <div class="col d-flex align-items-start">
                        {% if uid != 0%}                        
                        <button type="button" class="btn btn-danger fa fa-trash m-1 d-lg-none" data-bs-toggle="modal" data-bs-target="#ModalLabel2edit{{uname}}">
                         
                        </button> 
                        {% endif %}  
                      </div>
                    </div>

                    <!-- Modal -->
                    <div class="modal fade" id="ModalLabel3edit{{uname}}" tabindex="-1" aria-labelledby="ModalLabel3edit{{uname}}" aria-hidden="true">
                      <div class="modal-dialog modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                          <div class="modal-header">
                            <h5 class="modal-title" id="ModalLabel3edit{{uname}}">Edit user name</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                          </div>

                          <form method="POST" action = "/setting/editaccountuname">
                            <div class="modal-body">
                              <div class="mb row">
                                <label for="inputNewuname" class="col-sm-5 col-form-label">New username</label>
                                <div class="col-sm-7">
                                  <input type="text" class="form-control" id="inputNewuname" name = "inputNewuname">
                                </div>
                                <label for="inputpwd" class="col-sm-5 col-form-label">Password</label>
                                <div class="col-sm-7">
                                  <input type="password" class="form-control" id="inputpwd" name = "inputpwd">
                                </div>
                              </div>
                            
                              <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <button class="btn btn-primary" type="submit" id='delete' >Confirm</button>
                              </div>
                            </div>
                          </form>

                        </div>
                      </div>
                    </div>

                    <!-- Modal -->
                    <div class="modal fade" id="ModalLabeledit{{uname}}" tabindex="-1" aria-labelledby="ModalLabeledit{{uname}}" aria-hidden="true">
                      <div class="modal-dialog modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                          <div class="modal-header">
                            <h5 class="modal-title" id="ModalLabeledit{{uname}}">Edit password</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                          </div>

                          <form method="POST" action = "/setting/editaccountpwd">
                            <div class="modal-body">
                              <div class="mb row">
                                <label for="inputoldpwd" class="col-sm-5 col-form-label">Old password</label>
                                <div class="col-sm-7">
                                  <input type="password" class="form-control" id="inputoldpwd" name = "inputoldpwd">
                                </div>
                              </div>
                              <div class="mb row">
                                <label for="inputNewpwd" class="col-sm-5 col-form-label">New password</label>
                                <div class="col-sm-7">
                                  <input type="password" class="form-control" id="inputNewpwd" name = "inputNewpwd">
                                </div>
                              </div>
                            </div>
                          
                            <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                              <button class="btn btn-primary" type="submit" id='save'>Save change</button>
                            </div>
                          </form>

                        </div>
                      </div>
                    </div>

                    <!-- Modal -->
                    <div class="modal fade" id="ModalLabel2edit{{uname}}" tabindex="-1" aria-labelledby="ModalLabel2edit{{uname}}" aria-hidden="true">
                      <div class="modal-dialog modal-dialog modal-dialog-centered">
                        <div class="modal-content">
                          <div class="modal-header">
                            <h5 class="modal-title" id="ModalLabel2edit{{uname}}">Confirm delete account</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                          </div>

                          <form method="POST" action = "/setting/deleteyouraccount">
                            <div class="modal-body">
                              <div class="row">
                                <label for="deleteuser" class="col-sm-5 col-form-label">User name</label>
                                <div class="col-sm-7">
                                  <input type="text" readonly class="form-control-plaintext" id="deleteuser" name="deleteuser" value={{ uname }}>
                                </div>
                                <label for="deleteuserid" class="col-sm-5 col-form-label">User ID</label>
                                <div class="col-sm-7">
                                  <input type="text" readonly class="form-control-plaintext" id="deleteuserid" name="deleteuserid" value={{ uid }}>
                                </div>
                                <label for="inputpwd" class="col-sm-5 col-form-label">Your account password</label>
                                <div class="col-sm-7">
                                  <input type="password" class="form-control" id="inputpwd" name = "inputpwd">
                                </div>
                              </div>
                            </div>
                          
                            <div class="modal-footer">
                              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                              <button class="btn btn-primary" type="submit" id='delete' >Delete</button>
                            </div>
                          </form>

                        </div>
                      </div>
                    </div>

                    
                  </div>
                </div>
                </div>
    
              </div>
            </div>
          </div>
        </div>
      </div>
    </body>
</html>

<script>
  $(document).ready(function () {
    $('#tableex').DataTable({
      "pageLength": 5,
    });
    $('#tabledb').DataTable({
      "pageLength": 5,
    });
    $('.dataTables_length').addClass('bs-select');
    
  });

</script>

